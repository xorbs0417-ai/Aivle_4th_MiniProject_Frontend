version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 20
    commands:
      - echo "Install phase"
      - node -v && npm -v
  pre_build:
    commands:
      - echo "Pre-build"
      - cd frontend              # 이미지 확인 결과, 여기에 package.json이 있습니다.
      - npm ci                   # npm install보다 빌드 환경에 최적화된 명령어입니다.
  build:
    commands:
      - echo "Build"
      - npm run build            # Vite 빌드 실행 (dist 폴더 생성)
  post_build:
    commands:
      - echo "Build completed on `date`"

artifacts:
  files:
    - 'appspec.yml'             # 반드시 포함되어야 함
    - 'scripts/**/*'            # 배포 스크립트 폴더가 있다면 포함
    - 'frontend/dist/**/*'      # 실제 빌드된 결과물
  # 만약 base-directory를 사용 중이라면, appspec.yml이 그 폴더 밖에 있어서 생기는 문제입니다.
  # 파일을 모두 포함할 수 있도록 경로 설정을 주의하세요.
